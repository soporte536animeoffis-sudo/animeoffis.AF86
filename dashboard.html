<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard Anime Offis</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Poppins', sans-serif; background: #300050; color: #fff; }
    a { text-decoration: none; color: inherit; }

    /* Sidebar */
    .sidebar { background: #3d006e; width: 240px; height: 100vh; position: fixed; top: 0; left: 0; padding: 20px; display: flex; flex-direction: column; gap: 15px; }
    .sidebar img.avatar { width: 100px; border-radius: 50%; margin: 0 auto; }
    .username { display: flex; align-items: center; justify-content: center; gap: 6px; margin-top: 10px; font-weight: bold; }
    .verificacion-img { width: 35px; height: 35px; border-radius: 50%; object-fit: cover; border: 2px solid white; display: none; }
    .sidebar button { background: #000; color: #fff; border: none; padding: 12px; border-radius: 10px; font-weight: bold; cursor: pointer; transition: background 0.3s; }
    .sidebar button:hover { background: #222; }
    .premium { background: linear-gradient(to right, gold, orange); color: #000; font-weight: bold; }

    /* Main content */
    .main { margin-left: 260px; padding: 20px; }
    .header { display: flex; justify-content: space-between; align-items: center; }
    .search { width: 100%; max-width: 500px; display: flex; }
    .search input { flex: 1; padding: 10px; border-radius: 20px 0 0 20px; border: none; }
    .search button { background: black; border: none; color: white; padding: 10px 20px; border-radius: 0 20px 20px 0; cursor: pointer; }
    .grid { margin-top: 30px; display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 20px; }
    .anime-card { background: #1a0033; padding: 10px; border-radius: 15px; text-align: center; }
    .anime-card img { width: 100%; border-radius: 10px; }
    .anime-card button { margin-top: 10px; background: #000; color: white; border: none; padding: 8px; border-radius: 8px; font-size: 0.9em; }

    /* Mobile responsive */
    @media (max-width: 768px) {
      .sidebar { display: none; }
      .main { margin-left: 0; padding: 10px; }
      .mobile-nav { position: fixed; bottom: 0; width: 100%; background: #3d006e; display: flex; justify-content: space-around; padding: 10px 0; z-index: 999; }
      .mobile-nav button { background: none; color: white; font-weight: bold; border: none; font-size: 0.9em; }
      .search { flex-direction: column; }
      .search input, .search button { width: 100%; border-radius: 10px; margin-bottom: 10px; }
    }

    /* Encabezado m√≥vil */
    .mobile-header { display: none; position: fixed; top: 0; left: 0; width: 100%; background: #3d006e; padding: 10px; display: flex; align-items: center; gap: 10px; color: white; z-index: 1000; }
    .mobile-header #menu-btn { background: none; border: none; color: white; font-size: 1.5em; cursor: pointer; }
    .mobile-title { font-weight: bold; font-size: 1.2em; }
    .mobile-title2 {
  font-weight: bold;
  font-size: 1.2em;
  position: relative;
  left: -30px; /* Mueve el texto 10px a la izquierda */
    }

    /* Men√∫ desplegable lateral */
    .mobile-menu { position: fixed; top: 0; left: -240px; width: 240px; height: 100%; background: #3d006e; padding: 20px; display: flex; flex-direction: column; gap: 15px; transition: left 0.3s ease; z-index: 999; }
    .mobile-menu button { background: none; border: none; color: white; font-size: 1em; text-align: left; padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.1); }
    .mobile-menu.show { left: 0; }

    /* Ocultar en PC */
    @media (max-width: 768px) {
      .sidebar { display: none; }
      .mobile-header { display: flex; }
    }

    .terms { margin-top: 40px; font-size: 14px; opacity: 0.7; }
     .anime-card button {
    background-color: #f47521; /* Naranja Crunchyroll */
    color: white;
    border: none;
    padding: 10px 15px;
    border-radius: 8px;
    font-size: 16px;
    cursor: pointer;
    transition: 0.3s;
  }

  .anime-card button:hover {
    background-color: #ff8c42; /* Un poco m√°s claro al pasar */
    transform: scale(1.05);
  }
  </style>
</head>
<body>

  <!-- SIDEBAR -->
  <div class="sidebar">
    <img id="avatar-img" src="https://i.ibb.co/k2HCPYqd/1742400066396.jpg" alt="Avatar" class="avatar" />
    <div class="username">
      <span id="username">Cargando...</span>
      <img class="verificacion-img" id="badge-img" src="" alt="Verificado" />
    </div>
    <button>Inicio</button>
    <button>Subtitulado</button>
    <button>Doblajes</button>
    <button>Horarios</button>
    <button class="premium">PREMIUM ACTIVO</button>
  </div>

  <!-- MAIN -->
  <div class="main">
    <div class="header">
      <div class="search">
        <input type="text" placeholder="Busca una serie" />
        <button>üîç</button>
      </div>
    </div>

    <section class="search-users">
    <input type="text" id="search-user-input" placeholder="nombre de usuario a buscar...">
    <button id="search-user-btn">Buscar</button>
</section>
<section class="search-users-results">
    <ul id="user-results-list"></ul>
</section>
    
    <h5>Actualmente nuestra p√°gina est√° en versi√≥n beta y no alojamos animes directamente.<br>
Los animes que ves te llevar√°n a sus versiones oficiales en Crunchyroll.
La beta finalizar√° el 22 de septiembre de 2025.<br>
Pr√≥ximamente esperamos traer contenido con licencia oficial para que disfrutes todo el anime legalmente y sin costo.<br>
¬°Gracias por tu apoyo y por ser parte de Anime Offis!</h5>

    <div class="anime-card">
  <img src="anime1.jpg" alt="Anime 1" />
  <button onclick="window.open('https://www.crunchyroll.com/series/G9VHN91DJ/the-angel-next-door-spoils-me-rotten?utm_medium=android&utm_source=share', '_blank')">
    Ver Temporadas
  </button>
</div>

<div class="anime-card">
  <img src="anime2.jpg" alt="Anime 2" />
  <button onclick="window.open(' https://www.crunchyroll.com/series/G8DHV784M/i-may-be-a-guild-receptionist-but-ill-solo-any-boss-to-clock-out-on-time?utm_medium=android&utm_source=share', '_blank')">
    Ver Temporadas
  </button>
</div>

    <div class="terms">
      <a href="terminos.html">T√©rminos y condiciones</a> <br>
      <a href="pol√≠tica.html">Pol√≠tica de privacidad</a> |
      <a href="acerca.html">Acerca de la p√°gina</a>
      <br>
      <h5>Anime siempre contigo ‚ùÑÔ∏è y con coraz√≥n Destiny oficial üòâ‚ù§Ô∏è</h5>
    </div> 
  </div>

  <!-- MOBILE HEADER -->
  <div class="mobile-header">
    <button id="menu-btn">‚ò∞</button>
    <span class="mobile-title">Anime Offis</span>
    <span class="mobile-title2">Descargar app</span>
    
  </div>

  <!-- MOBILE MENU -->
  <div id="mobile-menu" class="mobile-menu">
    <button>Inicio</button>
    <button>Sub</button>
    <button>Doblajes</button>
    <a href="perfil.html">perfil</a>
  </div>

  <!-- FIREBASE -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAu0WbdAi8_yA2S6qKMUCLfty5w0PxgKVE",
      authDomain: "anime-offis.firebaseapp.com",
      projectId: "anime-offis",
      storageBucket: "anime-offis.appspot.com",
      messagingSenderId: "377121993034",
      appId: "1:377121993034:web:a4ba7995e827bcbea411b3"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    auth.onAuthStateChanged(user => {
      if (user) {
        db.collection('users').doc(user.uid).get().then(doc => {
          if (doc.exists) {
            const userData = doc.data();

            // Username
            document.getElementById('username').textContent = userData.username || user.displayName || "Usuario";

            // Foto de perfil
            const avatarImg = document.getElementById('avatar-img');
            if (userData.profilePhoto) {
              avatarImg.src = userData.profilePhoto;
            } else if (user.photoURL) {
              avatarImg.src = user.photoURL;
            } else {
              avatarImg.src = "https://i.ibb.co/k2HCPYqd/1742400066396.jpg";
            }

            // Insignia
            const badgeImg = document.getElementById('badge-img');
            let badgeSrc = "";
            switch (userData.verified) {
              case "creador": badgeSrc = "crea.png"; break;
              case "colaborador": badgeSrc = "cola.png"; break;
              case "aportador": badgeSrc = "aportador.png"; break;
              case "soporte": badgeSrc = "soport.png"; break;
              case "beta": badgeSrc = "beta.png"; break;
              case "dora": badgeSrc = "verif.png"; break;
              case "azul": badgeSrc = "azul.png"; break;
              case "verde": badgeSrc = "verde.png"; break;
              default: badgeSrc = "verde.png";
            }
            badgeImg.src = badgeSrc;
            badgeImg.style.display = "inline-block";
          }
        });
      } else {
        window.location.href = "login.html";
      }
    });

    // Mostrar / ocultar el men√∫ m√≥vil
    document.getElementById("menu-btn").addEventListener("click", () => {
      document.getElementById("mobile-menu").classList.toggle("show");
    });
      // Evento para realizar la b√∫squeda de usuarios
    document.getElementById("search-user-btn").addEventListener("click", function () {
        let searchQuery = document.getElementById("search-user-input").value.toLowerCase();
        let userResultsList = document.getElementById("user-results-list");
        userResultsList.innerHTML = ""; // Limpiar resultados anteriores

        if (searchQuery === "") {
            return; // No hacer nada si no hay texto en la b√∫squeda
        }

        // Recorrer todos los documentos de la colecci√≥n 'users'
        db.collection("users")
            .get()  // Obtiene todos los documentos dentro de la colecci√≥n 'users'
            .then((querySnapshot) => {
                let foundUsers = false;

                querySnapshot.forEach((doc) => {
                    let userData = doc.data();
                    // Verificar si el 'username' contiene el t√©rmino de b√∫squeda
                    if (userData.username && userData.username.toLowerCase().includes(searchQuery)) {
                        foundUsers = true;
                        let li = document.createElement("li");
                        li.textContent = userData.username + " - " + userData.email;
                        li.addEventListener("click", function () {
                            // Verificar que el doc.id es el correcto
                            console.log("Redirigiendo al perfil del usuario con ID: ", doc.id);
                            window.location.href = `perfil.html?usuario=${doc.id}`; // Redirigir con el ID del usuario encontrado
                        });
                        userResultsList.appendChild(li);
                    }
                });

                if (!foundUsers) {
                    userResultsList.innerHTML = "<li>No se encontraron usuarios.</li>";
                }
            })
            .catch((error) => {
                console.error("Error al buscar usuarios:", error);
                userResultsList.innerHTML = "<li>Error al buscar usuarios.</li>";
            });
    });
  </script>
</body>
</html>
